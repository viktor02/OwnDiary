# OwnDiary

## Описание

Личный дневник.

База данных - SQLite3.
CSS framework - Bootstrap 4

## История изменений

### 22.04.2019

* Подправил дизайн на странице записей.
* Исправил обработку html-тегов на главной странице.
* Исправил truncate text на главной.

### 21.04.2019

* Добавил удаление постов и пользователей через админ панель.
* Изменил логику проверки на админа. Теперь проверяетя роль пользователя, хранящаяся в сессии.
* Добавил установку роли пользователю в панели администратора.
* Убрал линки на css и js, заменив локальными, ускорив сайт.
* Изменил navbar, добавил линк на панель администратора.

### 19.04.2019

* Исправил ошибки.
* Добавил проверку на существование почты при регистрации.
* Добавлена роль админа и пользователя. По-умолчанию ставится роль пользователя. Пока что необходимо вручную через базу ставить роль админа.

<table><tr><th>id</th><th>email</th><th>name</th><th>username</th><th>password</th><th>salt</th><th>regdate</th><th>birthday</th><th>role</th><tr><tr><td>1</td><td>vitka.k@yandex.ru</td><td>Viktor</td><td>vitka-k</td><td>66dc72dc918e78efd0f8d3df8a48c7e83cbe7c90</td><td>RF3uBmBdMY</td><td>April 20, 2019, 00:56</td><td>1337-10-10</td><td>user</td></tr><tr><td>2</td><td>admin@adm.in</td><td>Admin Ivanovich</td><td>admin</td><td>bf738a329e6be4e34d0508a6347c5b805c746876</td><td>GlXqLKrIcW</td><td>April 20, 2019, 18:20</td><td>2011-08-19</td><td>admin</td></tr></table>

### 15.04.2019

* Полностью изменен дизайн. Фреймворк - Bootstrap 4
* Убран редактор CKEditor за ненадобностью.
* Изменена структура проекта.
* Добавлена простая админ-панель. Просмотр пользователей, всех записей и удаление записи.
* Добавлен просмотр профиля.

### 12.04.2019

* Добавлено нормальное экранирование строк при запросе в базу данных.
* Добавлено разделение по пользователям. Теперь пользователь видит только свои записи, а не все.
* Добавлено поле никнейма, емейл используется только для регистрации.

### 07.04.2019

* Создание базы происходит только во время регистрации.
* К паролю добавляется уникальная соль, которая хранится в базе.
* Переписана авторизация.
* Рефакторинг кода добавления записи

### 23.02.2019

* Добавил автоматическое изменение прав на файл базы данных. Теперь не возникает ошибки, если грузить на хостинг с линуксом.

### 30.01.2019

* Убрал ненужный скрипт с главной.
* Добавил автоматическую вставку даты. 
* Добавил защиту базы данных через .htaccess
* Добавил авторизацию и email автора при просмотре

### 21.01.2019

* Добавил CKEditor
* Сортировка по убыванию id
* Сделал подобие защиты от XSS атаки и теперь отображаются не все теги, а только некоторые
(` <p> <b> <i> <blockquote> <br> <del> <strong> <em> <s> <li> <ol>`)

## TODO

* Добавить настройки 
* Возможность прикрепления файлов 
* Проверка на пустую строку в редакторе.
* Переделать код обрезания тегов. Описан в файле *record.php*
* Добавить проверку на существование почты
* ~~Добавить поле возраста в базу.~~
* ~~Добавить дату регистрации в базу.~~

* В php имеются свои собственные функции хеширования и проверки пароля, в будущем нужно переписать код под их использование.